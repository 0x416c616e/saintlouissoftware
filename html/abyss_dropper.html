<!DOCTYPE html>
<html lang="en">
  <head>
    <!--open graph protocol-->
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Abyss Dropper" />
    <meta property="og:url" content="https://saintlouissoftware.com/abyss_dropper.html" />
    <meta property="og:image" content="https://saintlouissoftware.com/images/abyss_dropper_575px.png" />
    <meta property="og:description" content="The point of this project is to show that a certain kind of file upload vulnerablity I found needs to be taken seriously." />
    <meta property="og:site_name" content="Saint Louis Software"/>
    <!--share buttons-->
      <script src="//platform-api.sharethis.com/js/sharethis.js#property=5b81a259de278e00111a436b&product=sticky-share-buttons"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124633103-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-124633103-1');
    </script>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> 
    <title>Abyss Dropper | Saint Louis Software</title>
    <link rel="icon" type="image/gif" href="../images/favicon.gif">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/site.css">
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
  </head>

  <body id="page-home">
      <div id="container">
      
          <header>
              <!--responsive banner-->
              
              <div class="text-center" id="headerThing">
                  <img src="../images/saint_louis02_cropped.png" id="firstImage" alt="Saint Louis Software Banner"  width="510" class="img-fluid"> <!--removed width="510" height="56"-->
                  
                
              </div>
                  <!--responsive navbar-->


                  <nav class="navbar navbar-toggleable-md navbar-inverse bg-faded" id="navThingId" style="z-index: 5001;">

                      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                      </button>

                      <a class="navbar-brand"><img src="../images/saint_louis02_cropped_text_only.png" alt="Saint Louis Software Banner" id="secondImage" class="img-fluid">&nbsp;</a>

                      <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        

                        <ul class="navbar-nav mr-auto nav-fill w-100">
                          <li class="nav-item">
                            <a class="nav-link" href="index.html">Home</a>
                          </li>   
                          <li class="nav-item active">
                              <a class="nav-link" href="projects.html">Projects</a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link" href="blog.html">Blog<span class="sr-only">(current)</span></a>
                        </li>
                    <li class="nav-item">
                      <a class="nav-link" href="about.html">About</a> 
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="contact.html">Contact</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="search.html"><i class="fas fa-search"></i></a>
                    </li>

                          <!--<li class="nav-item">
                              <a href="login.html"><i class="fa fa-sign-in" id="loginButton"></i></a>
                          </li>-->
                        </ul>

                    
                          <!--<div id="formDivSearch">
                            <form class="form-inline my-2 my-lg-0" id="searchButton">
                              <input class="form-control mr-sm-2 fas fa-search" id="searchField" type="text" placeholder="&#xF002;">
                              <button class="btn btn-outline-primary inline my-2 my-sm-0 " id="searchButtonButton" type="submit" id="searchText">Search</button>
                            </form>
                        </div>-->
                      </div>
                    </nav><a id="titleAnchor"></a>
                  </header>

      <main class="content" id="mainId">
          <div class="container">
            <h1 class="pageTitle">Abyss Dropper</h1>


                  <div class="investingArticle">
                    <div class="text-center"><img src="../images/abyss_dropper_575px.png" class="center-block" id="articlePhoto" alt=""></div>
                    <p>First and foremost, if there's anything I've learned in recent years, it's that security projects need cool names and logos (see: Heartbleed, Shellshock, Stagefright, etc), or else people will be bored to death with all the technical details. Everyone remembers Heartbleed, but nobody remembers CVE-2014-0160 (even though they're the same thing). You need to make it seem more interesting and easy to remember, or else it might not get much attention. Abyss Dropper is a multi-stage dropper which coincides with some semi-related security research I conducted on my own.</p>
                    <p>I made a file steganography tool called <a href="filehider.html">FileHider</a>, which is a tool for hiding files within other files. I decided to test files I made using this tool on a number of websites. The result was very surprising. Many websites don't properly validate image uploads. This means you can upload arbitrary files to many public, well-known, fast, high-availability, highly-trusted websites. </p>
                    <p>Some sites use something like imagemagick in order to compress images, and they sometimes get rid of exif metadata as well. But some just leave an image as-is, and even leave any trailing data too. But recompression isn't enough. There are a few different methods of steganography, such as least significant bit, but that changes the image slightly, and can be thwarted by simple recompression.</p>
                    <div class="text-center"><img src="../images/hex_editor_abyss.png" class="center-block" id="articlePhoto" alt=""></div>
                    <p>This issue pertains specifically to JPGs, PNGs, and GIFs. I could go more into detail about why that's the case, but that might enable bad people to use this same basic concept. Each of these can have files embedded within them without corrupting the image. If you try to add arbitrary data to a word document, for example, it will become corrupt and MS Office will complain when you open it. </p>
                    
                    <div class="text-center"><img src="../images/corrupt_document.png" class="center-block" id="articlePhoto" alt=""></div>
                    <p>But when you hide files within image files, the image is still valid, and can even be completely unchanged if you use my particular method of steganography. However, it is possible to hide files within image files that are stored in other files, such as having a FileHider image inside of a word document, but LibreOffice seems to be better for steganography than Microsoft Word, for some reason.</p>
                    <p>There are many problems with the way a lot of sites handle image file uploads, but instead of leaving the potential for misuse up to someone's imagination, I decided to come up with a proof-of-concept malware dropper that can be used in conjunction with FileHider and the steganographic file upload vulnerability. A dropper is a piece of malware whose only purpose is to be compact and look relatively benign and then download and execute a payload when it's executed. Some potential attack vectors could be a maldoc, trojanized software on a torrent tracker, PDF reader code execution CVE, or something like that. </p>
                    <p>But in many cases, it's easy to see when a dropper is downloading its next stage from a malicious domain. Some malware uses domain-generating algorithms, which can have suspicious-looking second level and even top level domains. Some malware uses hacked sites, though they are often small businesses or relatively unknown sites. Definitely not Alexa/Moz top 500 sites. What separates Abyss Dropper from other forms of payload delivery is that Abyss Dropper uses domains and file types that are generally trusted and thought to be non-malicious. Another idea I had related to this concept is writing an image parser that can check for post-EOI/post-IEND/post-trailer data in image formats (which would be capable of detecting Abyss Dropper stages).</p>
                    <p>Malware with no dropper is considered single-stage, since everything happens at once. But droppers can be multi-stage. A typical dropper might only be two stages: running the dropper, then downloading everything else. Or it can be as many stages as you want. An abyss is really deep or even endless, and that's why I called my dropper Abyss Dropper.</p>
                    
                    <p>How Abyss Dropper works is that you take your payload and break it up into smaller pieces (I might make a tool to automate this process, but for now, it's manual), and then you use FileHider to hide the encrypted pieces of the payload within image files that you will manually upload to various trusted websites that have this file upload issue.</p>
                    <p>From there, you use Abyss Dropper to generate a dropper that will download the pieces of the payload, put them back together, and execute it.</p>
                    <p>I plan on eventually adding pseudo-polymorphic features to it, at least basic stuff like string randomization. That will thwart basic IOC stuff.</p>
                    

                    <div class="text-center"><img src="../images/steganography.png" class="center-block" id="articlePhoto" alt=""></div>
                    <p>The point of this project is to show that a certain kind of file upload vulnerablity I found needs to be taken seriously. Because it's not as obvious as other kinds of security issues, this steganographic upload problem might not be fixed unless I show how it can be used for bad things.</p>
                    <p>Abyss Dropper is only intended to be used for educational or demonstrative purposes, and for that reason I am not making it public. I am sharing it with people I know in person. For example, if I'm networking with someone or going to a job/internship interview, I don't mind letting someone see it. But I don't want to make it available to just any old person because of how it can be used maliciously.</p>
                    <p>I am a benevolent security researcher and I mean no harm, which is why I take responsible disclosure seriously, and why not all of my security projects are available online right now.</p>
                    <p>If you are interested in Abyss Dropper, please <a href="contact.html">contact me here.</a></p>
                    <p>Abyss Dropper will be available on GitHub <a href="https://github.com/0x416c616e/abyssdropper">here</a> in the near future.</p>
                  </div>
                
       
               
                <div id="disqus_thread"></div>
            <script>

              /**
              *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
              *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
              
              var disqus_config = function () {
              this.page.url = 'https://saintlouissoftware.com/abyss_dropper.html';  // Replace PAGE_URL with your page's canonical URL variable
              this.page.identifier = '00000028'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
              };
              
              (function() { // DON'T EDIT BELOW THIS LINE
              var d = document, s = d.createElement('script');
              s.src = 'https://saintlouissoftware.disqus.com/embed.js';
              s.setAttribute('data-timestamp', +new Date());
              (d.head || d.body).appendChild(s);
              })();
              </script>
              <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                  <div class="investingPageSelection">
                      <nav aria-label="Page navigation example">
                          <ul class="pagination justify-content-center">
                            <li class="page-item">
                              <a class="page-link" href="projects.html"><i class="fas fa-arrow-left"></i> Return to Projects</a>
                            </li>
                          </ul>
                        </nav>
                  </div>
                  <footer>
                      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h5 class="modal-title" id="exampleModalLabel">Email</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body" id="mMod">
                              <p class="text-center">Please send an email to:<br>
                                  <img src="../images/send.png"><br>Or use the contact form <a id="contactHere" href="contact.html">here</a>
                              </p>
                              
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                              
                            </div>
                          </div>
                        </div>
                      </div>
                      <p class="contactClass text-center"><a href="contact.html">Contact:</a></p>
                      <a class="fas fa-envelope" data-toggle="modal" data-target="#exampleModal" id="emLink"></a>  
                      <a class="fab fa-twitter" href="https://twitter.com/0x416c616e"></a>
            
                      <a class="fab fa-reddit" href="https://www.reddit.com/user/0x6f6d67686178"></a>  
                      <a class="fab fa-github" href="https://github.com/0x416c616e"></a>
                      <a class="fab fa-goodreads" href="https://www.goodreads.com/user/show/68320487-alan"></a>
                      <a class="fab fa-slack" href="https://bobasort.slack.com"></a>
                      <nav class="fab parentCuriousCat">
                          <img class="image1CuriousCat" src="../images/curious_cat_hover.png" />
                          <a href="https://curiouscat.me/0x416c616e"><img class="image2CuriousCat" src="../images/curious_cat.png" /></a>
                      </nav>


                      <!--<a href="https://curiouscat.me/0x416c616e"><img src="../images/curious_cat.png" style="position:relative; top:-7px;"></a>-->
                      <div class="footerCopyright">
                          <p>
                          <script type="text/javascript" >
                            var today = new Date();
                            document.write( "&copy;&nbsp;" );
                            document.write( today.getFullYear() );
                            document.write( " Saint Louis Software" )
                        </script></p>
                      </div>
                      <nav aria-label="Page navigation example">
                          <ul class="pagination justify-content-center">
                            <li class="page-item">
                              <a class="page-link" id="backToTopButton" href="#titleAnchor"><i class="fas fa-angle-double-up"></i> Back to top <i class="fas fa-angle-double-up"></i></a>
                            </li>
                          </ul>
                        </nav>
                    </footer>
                </div>
          

            </div>
        </main>
        <div class="privacy-banner" style="border-top: 2px solid #24305e; display: none;">
          <div>
            <p>
              We use cookies to provide and improve our services. By using our site, you consent to cookies.
              <a class="banner-accept" href="javascript:void(0);" style="background: #24305e">Accept</a><div id="gdprSpacer">&nbsp;</div><div id="gdprSpacer2">&nbsp;</div>
              <!--<a class="banner-learn" href="/terms/privacy-policy.stml">Learn more</a>--> <!--do this later-->
            </p>
          </div>
          <noscript>Please enable JS for this site to work properly.</noscript>
        </div>
        <script src="../js/gdpr.js"></script>
      

    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="../js/scroll.js"></script>
      
    </div>
  </body>
</html>